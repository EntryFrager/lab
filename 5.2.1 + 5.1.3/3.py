import numpy as np
import matplotlib.pyplot as plt

# --- Данные ---
U = np.array(
    [
        8.367,
        7.632,
        7.220,
        7.022,
        6.866,
        6.629,
        8.584,
        8.721,
        9.005,
        9.271,
        9.403,
        9.652,
        9.870,
        10.028,
        10.283,
        10.808,
        8.486,
        6.467,
        6.268,
        6.003,
        5.780,
        5.611,
        5.398,
        5.180,
        5.016,
        4.832,
        4.624,
        4.422,
        4.222,
        4.075,
        3.753,
        3.498,
        3.248,
        3.013,
        2.812,
        2.604,
        2.447,
        2.270,
        2.072,
        1.842,
        1.596,
        1.366,
        0.902,
        0.517,
        0.783,
        0.921,
        1.062,
        1.109,
    ]
)

I = np.array(
    [
        107.82,
        92.20,
        87.19,
        84.99,
        83.29,
        81.45,
        111.09,
        114.45,
        122.49,
        128.61,
        131.68,
        142.01,
        155.01,
        165.60,
        178.03,
        196.34,
        111.74,
        83.07,
        81.98,
        80.98,
        80.53,
        80.44,
        80.69,
        81.25,
        82.0,
        83.09,
        84.78,
        86.84,
        89.37,
        91.56,
        97.47,
        103.47,
        110.67,
        119.02,
        127.70,
        138.95,
        148.98,
        161.94,
        178.09,
        194.76,
        198.01,
        171.23,
        44.07,
        1.59,
        20.21,
        50.30,
        91.30,
        105.81,
    ]
)

# --- Сортировка по напряжению ---
idx = np.argsort(U)
U_sorted = U[idx]
I_sorted = I[idx]

# --- Фиксируем максимум тока вручную ---
I0 = 198.34  # мкА
print("Используем I0 =", I0, "мкА")

# --- Вычисляем w(U) ---
w = -np.log(I_sorted / I0)

# --- График ---
plt.figure(figsize=(8, 5))
plt.plot(U_sorted, w, "o-", markersize=4)

plt.title("Вероятность рассеяния: w(U)")
plt.xlabel("U, В")
plt.ylabel(r"$w(U) = -\ln(I/I_0)$")

plt.grid(True)
plt.minorticks_on()
plt.grid(which="minor", linestyle=":", alpha=0.3)

plt.gca().invert_xaxis()  # как на ВАХ

plt.tight_layout()
plt.show()
